
<div class="table-responsive" data-ng-class="{'preview-wrapper': $ctrl.browser.showPreviewListing}">
    <div
        data-ng-class="{'ds-table-display-wrapper' : $ctrl.fileListing.length > 10}"
        ds-infinite-scroll
        data-scroll-bottom="$ctrl.handleScroll()"
        data-scroll-top="$ctrl.scrollToTop()"
        data-bottom-height="0"
    >
        <div id="listingtop"></div> 
        <div>
            <span ng-repeat="path in $ctrl.breadcrumbs track by $index">
                <span ng-if="!$last"><a ng-click="$ctrl.breadcrumbBrowse($event, path)">{{ path || 'Main' }}</a> / </span>
                <span ng-if="$last">{{ path || 'Main' }}</span>
            </span>
        </div>
        <table class="files-listing-table table table-bordered table-striped"
               style="background-color: #fff;">
            <thead>
                <tr>
                    <th>
                        <span ng-if="$ctrl.showSelect">
                            <i class="fa fa-lg fa-check-square" style="color:#337ab7;" ng-click="$ctrl.selectAll()"></i>
                            <span>Name</span>
                        </span>
                        <span ng-if="!$ctrl.showSelect">Name</span>
                    </th>
                    <th>Size</th>
                    <th>Last modified</th>
                    <th ng-if="$ctrl.operationLabel">Operation</th>
                </tr>
            </thead>
            <tbody>
                <tr
                    data-ng-repeat="item in $ctrl.fileListing"
                    ng-class="{highlight: item.selected}"
                >
                    <td class="unselectable">
                        <span ng-if="$ctrl.showSelect">
                            <span class="fa-stack fa-lg" style="margin: -8px;" ng-if="item.selected" data-ng-click="$ctrl.onSelect($index)">
                                <i class="fa fa-square fa-stack-1x" style="color: white;"></i>
                                <i class="fa fa-check-square fa-stack-1x" style="color:#1CB500;"></i>
                            </span>
                            <span class="fa-stack fa-lg" style="margin: -8px;" ng-if="!item.selected" data-ng-click="$ctrl.onSelect($index)">
                                <i class="fa fa-square fa-stack-1x" style="color: white;"></i>
                                <i class="fa fa-square-o fa-stack-1x" style="color:lightgray;"></i>
                            </span>
                        </span>
                        <i class="fa {{ item.icon() }}">&nbsp;</i>
                        <a ng-if="item.type === 'dir'" data-ng-href="#" data-ng-click="$ctrl.onBrowse({$event: $event, path: item.path})">
                            {{ item.name }}
                        </a>
                        <span ng-if="item.type !== 'dir'">
                            {{ item.name }}
                        </span>
                        <div class="project-categories">
                            <div class="file-categories"
                                 data-ng-if="$ctrl._ui.editTags || $ctrl._ui.showTags">
                                <file-categories data-project="$ctrl.browser.project"
                                                 data-file="item"
                                                 data-show-tags="$ctrl._ui.showTags"
                                                 data-edit-tags="$ctrl._ui.editTags"
                                >
                                </file-categories>
                            </div>
                            <div class="file-categories-selector"
                                 data-ng-if="$ctrl._ui.editTags">
                                <file-category-selector data-project="$ctrl.browser.project"
                                                        data-file="item"
                                >
                                </file-category-selector>
                            </div>
                            <div data-ng-if="$ctrl.browser.loadingEntities">
                                <i class="fa fa-spinner fa-spin">&nbsp;</i> Loading ...
                            </div>
                        </div>
                    </td>
                    <td data-ng-if="item.format== 'folder'">--</td>
                    <td data-ng-if="item.format== 'raw'">{{ item.length|bytes }}</td>
                    <td >{{ item.lastModified|date:"short" }}</td>
                    <td data-ng-if="$ctrl.operationLabel">
                        <button ng-if="item.type==='dir'" ng-click="$ctrl.operation({file: item})">{{$ctrl.operationLabel}}

                        </button></td>
                </tr>
                <tr >
                    <td colspan="4" style="height: 37px;">
                        <span class="bg-info text-info" ng-if="$ctrl.loadingScroll">
                            <i class="fa fa-spinner fa-spin">&nbsp;</i>
                            Loading...
                        </span>
                    </td>
                </tr>
            </tbody>
            <caption style="padding:0px;">
                <div data-ng-if="$ctrl.loading"
                     style="padding:10px; font-size:large; width:100%;"
                     class="bg-info"
                 >
                    <span>
                        <i class="fa fa-spinner fa-spin">&nbsp;</i>
                        Loading...
                    </span>
                </div>
                <div data-ng-if="!$ctrl.loading && $ctrl.error" class="text-center">
                    <div class="alert alert-danger">
                        <div data-ng-if="$ctrl.error.message"
                             data-ng-bind-html="$ctrl.error.message">
                            {{$ctrl.browser.error}}
                        </div>
                        <div data-ng-if="!$ctrl.error.message">
                            Something went wrong.
                        </div>
                    </div>
                </div>
                <div data-ng-if="! $ctrl.loading &&
                                 ! $ctrl.error &&
                                 ($ctrl.listing().children.length) === 0"
                     style="background-color: #fff;border: 1px solid #ddd;padding:8px;"
                     class="text-center"
                >
                    <p class="lead" style="margin-top:20px" ng-if="$ctrl.listing().type">
                        This folder is empty! <br />
                        <i class="fa fa-folder-open-o">&nbsp;</i><br/>
                        <a data-ng-if="$ctrl.listing().system.indexOf('project-') == 0"
                           href="https://www.youtube.com/watch?v=ITf4hlBamGU&list=PL2GxvrdFrBlkwHBgQ47pZO-77ZLrJKYHV"
                           target="_blank"
                        >
                            <i class="fa fa-question-circle" style="font-size: 18px;">&nbsp;</i>
                            Learn how to move files to a project
                        </a>
                    </p>
                    <p class="lead" style="margin-top:20px" ng-if="!$ctrl.listing().type">
                        <i class="fa fa-file-text-o">&nbsp;</i><br/>
                        <a href="https://www.youtube.com/watch?v=lfBe04ihQUs&list=PL2GxvrdFrBlkwHBgQ47pZO-77ZLrJKYHV" target="_blank">
                            <i class="fa fa-question-circle" style="font-size: 18px;">&nbsp;</i>
                            Learn how to assign files to categories<br/>
                        </a>
                    </p>
                </div>
            </caption>
        </table>
    </div>
</div>
