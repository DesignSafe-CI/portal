<div class="table-responsive" ng-class="{'preview-wrapper': browser.showPreviewListing}">

  <div class="ds-table-display-wrapper" ds-infinite-scroll
   data-scroll-bottom="scrollToBottom()()"
   data-scroll-top="scrollToTop()()"
   data-bottom-height="0"
   ng-if="browser.showMainListing ||
          (browser.showPreviewListing &&
          browser.project.value.projectType == 'other' &&
          (!browser.publishPipeline ||
          browser.publishPipeline == 'select' ||
          browser.publishPipeline == 'review'))">
    <table class="table table-bordered table-striped" style="background-color: #fff;">
      <thead>
        <th>Name</th>
        <th>Size</th>
        <th>Last modified</th>
      </thead>
      <tbody>
        <tr ng-if="!browser.busyListing"
         ng-repeat="item in browser.listing.children"
         ng-click="onSelect()($event, item)"
         ng-class="{'ds-data-selected': item._ui.selected}">
          <td>
            <i class="fa {{ item.icon() }}"></i>
            <a ng-href="{{ item.href }}" ng-click="onBrowse()($event, item)">
              {{ item.name }}
            </a>
            <span class="tag-item"
             ng-repeat="entityTag in item._entityTags">
              {{entityTag}}
            </span>
            <div style="width:100%;">
              <span ng-if="browser.loadingEntities">
                Loading <i class="fa fa-spinner fa-spin"></i>
              </span>
              <span class="label selected"
               ng-repeat-start="entity in item._entities"
               ng-class="entity.cssClasses()['tag']">
                {{ entity._displayName }}
              </span>
              <span ng-repeat-end class="tag-title">
                {{entity.value.title}}
              </span>
            </div>
          </td>
          <td ng-if="item.format== 'folder'"> -- </td>
          <td ng-if="item.format== 'raw'">{{ item.length|bytes }}</td>
          <td>{{ item.lastModified|date:"short" }}</td>
        </tr>
        <tr ng-if="browser.busyListingPage">
          <td>
            <span class="bg-info text-info">
              <i class="fa fa-spinner fa-spin"></i> Loading...
            </span>
          </td>
        </tr>
      </tbody>
      <caption style="padding:0px;">
        <div ng-if="browser.busy"
         style="padding:10px; font-size:large; width:100%;"
         class="bg-info">
          <span>
            <i class="fa fa-spinner fa-spin"></i> Loading...
          </span>
        </div>
        <div ng-if="! browser.busy && browser.error" class="text-center">
          <div class="alert alert-danger">
            <div ng-if="browser.error.message" ng-bind-html="browser.error.message"></div>
            <div ng-if="!browser.error.message"> Somthing went wrong </div>
          </div>
        </div>
        <div ng-if="! browser.busy && ! browser.error && (browser.listing.children|length) === 0" style="background-color: #fff;border: 1px solid #ddd;padding:8px;" class="text-center">
          <p class="lead">
            This folder is empty! <br>
            <i class="fa fa-folder-open-o"></i><br/>
            <a class="" ng-if="browser.listing.system.indexOf('project-') == 0"
               href="https://www.youtube.com/watch?v=ISrPManDVCYi&list=PL2GxvrdFrBlkwHBgQ47pZO-77ZLrJKYHV"
               target="_blank">
               <i class="fa fa-question-circle"></i> Learn how to move files to a project
            </a>
          </p>
        </div>
      </caption>
    </table>
  </div>


<div class="simulation-publishing-steps"
 ng-if="browser.showPreviewListing &&
        browser.project.value.projectType == 'simulation' ">
  <div ng-repeat="simulation in publicationCtrl.filterSimulations(browser.project.simulation_set) | orderBy: 'value.title'"
       ng-if="browser.showPreviewListing &&
              (!browser.publishPipeline ||
               browser.publishPipeline == 'select' ||
               browser.publishPipeline == 'review')" style="background:#fff;">

    <div class="dropdown entity-preview-header" id="details-{{simulation.uuid}}">
      <button class="btn btn-default btn-sm" data-toggle="collapse" data-target="#data-{{simulation.uuid}}"
              style="width:100%">
        Simulation {{simulation.value.title}} <i class="fa dropdown-caret"></i>
      </button>
      <div id="data-{{simulation.uuid}}" class="collapse"
           ng-class="{'in': $index==0}">

        <div style="border:1px solid black; background:white; margin-bottom:15px;">
          <div style="padding:5px;">
            <h3 style="margin-top:0">{{simulation.value.title}}</h3>
            <p style="font-weight:bold;">Description</p>
            <p>{{simulation.value.description}}</p>
          </div>

          <div style="width:49%; vertical-align:top; display:inline-block;">
            <div>
              <span style="font-weight:bold; display:inline-block; width:150px;"> Date of Publication: </span> (Appears when published)
            </div>
            <div>
              <span style="font-weight:bold; display:inline-block; width:150px;"> DOI: </span> (Appears when published)
            </div>
            <div>
              <span style="font-weight:bold; display:inline-block; width:150px;"> Simulation Type: </span>
              <span ng-if="simulation.value.simulationType !== 'Other'">{{simulation.value.simulationType}}</span>
              <span ng-if="simulation.value.simulationType === 'Other'">{{simulation.value.simulationTypeOther}}</span>
            </div>
          </div>
          <div style="width:49%; vertical-align:top; display:inline-block;">
            <div>
              <span style="font-weight:bold; display:inline-block; width:150px;"> Authors: </span>
              <span ng-repeat="user in publicationCtrl.filterUsers(simulation.value.authors,
                               browser.publication.users) | orderBy: ['_ui.order', 'last_name']" > {{user.last_name}}, {{user.first_name}};
              </span>
            </div>
            <div ng-if="browser.project.getRelated('analysis_set', simulation.uuid, 'simulations').length">
              <span style="font-weight:bold; display:inline-block; width:150px;"> Simulation Analysis: </span>
              <a ng-href="#data-{{browser.project.getRelated('analysis_set', simulation.uuid, 'simulations')[0].uuid}}">
                {{browser.project.getRelated('analysis_set', simulation.uuid, 'simulations')[0].value.title}}
              </a>
            </div>
            <div ng-if="browser.project.getRelated('report_set', simulation.uuid, 'simulations').length">
              <span style="font-weight:bold; display:inline-block; width:150px;"> Simulation Report: </span>
              <a ng-href="#data-{{browser.project.getRelated('report_set', simulation.uuid, 'simulations')[0].uuid}}">
                {{browser.project.getRelated('report_set', simulation.uuid, 'simulations')[0].value.title}}
              </a>
            </div>
          </div>
          <div ng-if="!publicationCtrl.filterSimulationModels(browser.project.getRelated('model_set', simulation.uuid), simulation).length"
               class="bg-info" style="padding:10px; margin-bottom:10px; border-bottom:1px solid black;">
                This Simulation has no Models.
          </div>
          <div ng-repeat="model in publicationCtrl.filterSimulationModels(browser.project.getRelated('model_set', simulation.uuid), simulation) | orderBy: ['_ui.order', 'value.title']"
               style="margin-bottom:10px;">
            <div style="padding:3px;">
              <span ng-class="model.cssClasses()['text']"class="older-tick">Simulation Model: {{model.value.title}} </span>
            </div>
            <div style="position:absolute; left:-110px; margin-top:-20px; width:110px;">
              <div style="border-bottom:1px solid lightgrey;">
                <a ng-class="model.cssClasses()['text']" ng-click="openPreviewTree()($event, model.uuid)" href="#">
                  {{model.value.title}}
                </a>
              </div>
              <div>
                <div ng-repeat="simInput in browser.project.getRelated('input_set', [model.uuid])"
                     style="border-radius:5px; border-left:1px solid black; border-right:1px solid black;
                            padding:0px 0px 3px 3px; margin: 3px 0px 0px 0px; width:90%;">
                  <a ng-class="simInput.cssClasses()['text']"
                     href=""
                     ng-click="openPreviewTree()($event, simInput.uuid)">
                    {{simInput.value.title}}
                  </a>
                  <div style="display:inline-block" ng-repeat="simOutput in browser.project.getRelated('output_set', [simulation.uuid, model.uuid, simInput.uuid])">
                    <a ng-class="simOutput.cssClasses()['text']" href="" ng-click="openPreviewTree()($event, simOutput.uuid)">
                      {{simOutput.value.title}}
                    </a>
                    <div style="display:inline-block" ng-repeat="analysis in browser.project.getRelated('analysis_set', [simOutput.uuid], 'simOutputs')">
                      <a ng-class="analysis.cssClasses()['text']" href="" ng-click="openPreviewTree()($event, analysis.uuid)">
                        {{analysis.value.title}}
                      </a>
                    </div>
                    <div style="display:inline-block" ng-repeat="report in browser.project.getRelated('report_set', [simOutput.uuid], 'simOutputs')">
                      <a ng-class="report.cssClasses()['text']" href="" ng-click="openPreviewTree()($event, report.uuid)">
                        {{report.value.title}}
                      </a>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div style="margin-left:-5px; padding-left:5px; margin-top:-11px; padding-top:7px; border-left:1px solid #ccc; border-radius:5px 0px 0px 5px; overflow:scroll;">
              <table  class="table table-bordered table-striped"
                      style="background-color: #fff;">
                <thead>
                  <th>Name</th>
                  <th>Size</th>
                  <th>Last modified</th>
                  <th ng-if="browser.publishPipeline && browser.publishPipeline === 'select'">
                    <button class="btn btn-default"
                            ng-if="publicationCtrl.filterFiles(false, model, browser.listings[model.uuid]).length &&
                                   !(browser.publication.filesSelected[model.uuid] &&
                                    browser.publication.filesSelected[model.uuid].length)"
                            ng-click="publicationCtrl.selectAllSimFiles(simulation); publicationCtrl.selectAllSimFiles(model)">
                      <i class="fa fa-check"></i> Select All
                    </button>
                    <button class="btn btn-default"
                            ng-if="browser.publication.filesSelected[model.uuid]
                                   && browser.publication.filesSelected[model.uuid].length"
                            ng-click="publicationCtrl.deselectAllSimFiles(simulation); publicationCtrl.deselectAllSimFiles(model)">
                      <i class="fa fa-times"></i> Deselect All
                    </button>
                  </th>
                </thead>
                <tbody>
                  <tr ng-repeat="file in publicationCtrl.filterFiles(false, model, browser.listings[model.uuid]) | orderBy: ['type', 'path']">
                    <td>
                      <i class="fa {{file.icon()}}"></i>
                      <a ng-href="{{file.href}}" ng-click="onBrowse()($event, file)">
                        {{file.name}}
                      </a>
                    </td>
                    <td>{{file.length|bytes}}</td>
                    <td>{{file.lastModified|date:"short"}}</td>
                    <td ng-if="browser.publishPipeline && browser.publishPipeline === 'select' ">
                      <button class="btn btn-success"
                              ng-if="publicationCtrl.isFileSelectedForSimPublication(model, file)"
                              ng-click="publicationCtrl.deselectFileForSimPublication(model, file)"
                              title="Selected">
                        <i class="fa fa-check"></i><span class="sr-only">Selected</span>
                      </button>
                      <button class="btn btn-danger"
                              ng-if="!publicationCtrl.isFileSelectedForSimPublication(model, file)"
                              ng-click="publicationCtrl.selectFileForSimPublication(model, file)"
                              title="Not Selected">
                        <i class="fa fa-times"></i><span class="sr-only">Not Selected</span>
                      </button>
                    </td>
                  </tr>
                  <tr class="simulation-input"
                      style="background:#fff; border:none;"
                      ng-repeat="simInput in browser.project.getRelated('input_set', [model.uuid])">
                   <td colspan="4">
                    <div class="entity-preview-header" id="details-{{simInput.uuid}}">
                      <button class="btn btn-default btn-sm" ng-class="simInput.cssClasses()['text']"
                              style="width:100%">Simulation Input {{simInput.value.title}}</button>
                    </div>
                    <table class="table table-bordered table-striped">
                      <tbody>
                        <tr ng-repeat="file in publicationCtrl.filterFiles(false, simInput, browser.listings[simInput.uuid]) | orderBy: ['type', 'path']">
                          <td>
                            <i class="fa {{file.icon()}}"></i>
                            <a ng-href="{{file.href}}" ng-click="onBrowse()($event, file)">
                              {{file.name}}
                            </a>
                          </td>
                          <td>{{file.length|bytes}}</td>
                          <td>{{file.lastModified|date:"short"}}</td>
                          <td ng-if="browser.publishPipeline && browser.publishPipeline === 'select' ">
                            <button class="btn btn-success"
                                    ng-if="publicationCtrl.isFileSelectedForSimPublication(simInput, file)"
                                    ng-click="publicationCtrl.deselectFileForSimPublication(simInput, file)"
                                    title="Selected">
                              <i class="fa fa-check"></i><span class="sr-only">Selected</span>
                            </button>
                            <button class="btn btn-danger"
                                    ng-if="!publicationCtrl.isFileSelectedForSimPublication(simInput, file)"
                                    ng-click="publicationCtrl.selectFileForSimPublication(simInput, file)"
                                    title="Not Selected">
                              <i class="fa fa-times"></i><span class="sr-only">Not Selected</span>
                            </button>
                          </td>
                        </tr>
                        <tr class="simulation-output"
                            style="background:#fff; border:none; padding:0; margin:0"
                            ng-repeat="simOutput in browser.project.getRelated('output_set', [model.uuid, simInput.uuid])">
                         <td colspan="4" style="padding:0; margin:0;">
                          <div class="entity-preview-header" id="details-{{simOutput.uuid}}">
                            <button class="btn btn-default btn-sm" ng-class="simOutput.cssClasses()['text']"
                                    style="width:100%">Simulation Output {{simOutput.value.title}}</button>
                          </div>
                          <table class="table table-bordered table-striped">
                            <tbody>
                              <tr ng-repeat="file in publicationCtrl.filterFiles(false, simOutput, browser.listings[simOutput.uuid]) | orderBy: ['type', 'path']">
                                <td>
                                  <i class="fa {{file.icon()}}"></i>
                                  <a ng-href="{{file.href}}" ng-click="onBrowse()($event, file)">
                                    {{file.name}}
                                  </a>
                                </td>
                                <td>{{file.length|bytes}}</td>
                                <td>{{file.lastModified|date:"short"}}</td>
                                <td ng-if="browser.publishPipeline && browser.publishPipeline === 'select' ">
                                  <button class="btn btn-success"
                                          ng-if="publicationCtrl.isFileSelectedForSimPublication(simOutput, file)"
                                          ng-click="publicationCtrl.deselectFileForSimPublication(simOutput, file)"
                                          title="Selected">
                                    <i class="fa fa-check"></i><span class="sr-only">Selected</span>
                                  </button>
                                  <button class="btn btn-danger"
                                          ng-if="!publicationCtrl.isFileSelectedForSimPublication(simOutput, file)"
                                          ng-click="publicationCtrl.selectFileForSimPublication(simOutput, file)"
                                          title="Not Selected">
                                    <i class="fa fa-times"></i><span class="sr-only">Not Selected</span>
                                  </button>
                                </td>
                              </tr>
                              <tr class="sim-data-analysis"
                                  style="background:#fff; border:none; padding:0, margin:0"
                                  ng-repeat="analysis in browser.project.getRelated('analysis_set', [simOutput.uuid], 'simOutputs')">
                               <td colspan="4" style="padding:0; margin:0;">
                                 <div class="entity-preview-header" id="details-{{analysis.uuid}}">
                                   <button class="btn btn-default btn-sm" ng-class="analysis.cssClasses()['text']"
                                           style="width:100%">Integrated Analysis {{analysis.value.title}}</button>
                                 </div>
                                <table class="table table-bordered table-striped">
                                  <tbody>
                                    <tr ng-repeat="file in publicationCtrl.filterFiles(false, analysis, browser.listings[analysis.uuid]) | orderBy: ['type', 'path']">
                                      <td>
                                        <i class="fa {{file.icon()}}"></i>
                                        <a ng-href="{{file.href}}" ng-click="onBrowse()($event, file)">
                                          {{file.name}}
                                        </a>
                                      </td>
                                      <td>{{file.length|bytes}}</td>
                                      <td>{{file.lastModified|date:"short"}}</td>
                                      <td ng-if="browser.publishPipeline && browser.publishPipeline === 'select' ">
                                        <button class="btn btn-success"
                                                ng-if="publicationCtrl.isFileSelectedForSimPublication(analysis, file)"
                                                ng-click="publicationCtrl.deselectFileForSimPublication(analysis, file)"
                                                title="Selected">
                                          <i class="fa fa-check"></i><span class="sr-only">Selected</span>
                                        </button>
                                        <button class="btn btn-danger"
                                                ng-if="!publicationCtrl.isFileSelectedForSimPublication(analysis, file)"
                                                ng-click="publicationCtrl.selectFileForSimPublication(analysis, file)"
                                                title="Not Selected">
                                          <i class="fa fa-times"></i><span class="sr-only">Not Selected</span>
                                        </button>
                                      </td>
                                    </tr>
                                  </tbody>
                                </table>
                               </td>
                              </tr>
                              <tr class="sim-int-report"
                                  style="background:#fff; border:none; padding:0, margin:0"
                                  ng-repeat="report in browser.project.getRelated('report_set', [simOutput.uuid], 'simOutputs')">
                               <td colspan="4" style="padding:0; margin:0;">
                                 <div class="entity-preview-header" id="details-{{report.uuid}}">
                                   <button class="btn btn-default btn-sm" ng-class="report.cssClasses()['text']"
                                           style="width:100%">Integrated Report {{report.value.title}}</button>
                                 </div>
                                <table class="table table-bordered table-striped">
                                  <tbody>
                                    <tr ng-repeat="file in publicationCtrl.filterFiles(false, report, browser.listings[report.uuid]) | orderBy: ['type', 'path']">
                                      <td>
                                        <i class="fa {{file.icon()}}"></i>
                                        <a ng-href="{{file.href}}" ng-click="onBrowse()($event, file)">
                                          {{file.name}}
                                        </a>
                                      </td>
                                      <td>{{file.length|bytes}}</td>
                                      <td>{{file.lastModified|date:"short"}}</td>
                                      <td ng-if="browser.publishPipeline && browser.publishPipeline === 'select' ">
                                        <button class="btn btn-success"
                                                ng-if="publicationCtrl.isFileSelectedForSimPublication(report, file)"
                                                ng-click="publicationCtrl.deselectFileForSimPublication(report, file)"
                                                title="Selected">
                                          <i class="fa fa-check"></i><span class="sr-only">Selected</span>
                                        </button>
                                        <button class="btn btn-danger"
                                                ng-if="!publicationCtrl.isFileSelectedForSimPublication(report, file)"
                                                ng-click="publicationCtrl.selectFileForSimPublication(report, file)"
                                                title="Not Selected">
                                          <i class="fa fa-times"></i><span class="sr-only">Not Selected</span>
                                        </button>
                                      </td>
                                    </tr>
                                  </tbody>
                                </table>
                               </td>
                              </tr>
                            </tbody>
                          </table>
                         </td>
                        </tr>
                      </tbody>
                    </table>
                   </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>

        </div>

      </div>
    </div>
  </div>

  <div ng-repeat="analysis in publicationCtrl.filterSimAnalysis(browser.project.analysis_set) | orderBy: ['value.title', 'value.simulations.length']"
       ng-if="browser.showPreviewListing &&
              (!browser.publishPipeline ||
               browser.publishPipeline == 'select' ||
               browser.publishPipeline == 'review')"
       style="#fff;">
    <div class="dropdown entity-preview-header" id="details-{{analysis.uuid}}">
      <button class="btn btn-default btn-sm" data-toggle="collapse" data-target="#data-{{analysis.uuid}}"
              style="width:100%" ng-class="analysis.cssClasses()['text']">
        <span ng-if="!analysis.value.simulations.length">Analysis {{analysis.value.title}} </span>
        <span ng-if="analysis.value.simulations.length">Simulation Analysis {{analysis.value.title}} </span>
        <i class="fa dropdown-caret"></i>
      </button>
          <div id="data-{{analysis.uuid}}" class="collapse in">
            <div style="border:1px solid black; background:white; padding:5px; margin-bottom:15px;">
              <table  class="table table-bordered table-striped"
                      style="background-color: #fff;">
                <thead>
                  <th>Name</th>
                  <th>Size</th>
                  <th>Last modified</th>
                  <th ng-if="browser.publishPipeline && browser.publishPipeline === 'select'">
                    <button class="btn btn-default"
                            ng-if="publicationCtrl.filterFiles(false, analysis, browser.listings[analysis.uuid]) &&
                                   !(browser.publication.filesSelected[analysis.uuid]
                                   && browser.publication.filesSelected[analysis.uuid].length)"
                            ng-click="publicationCtrl.selectAllSimFiles(analysis)">
                      <i class="fa fa-check"></i> Select All
                    </button>
                    <button class="btn btn-default"
                            ng-if="browser.publication.filesSelected[analysis.uuid]
                                   && browser.publication.filesSelected[analysis.uuid].length"
                            ng-click="publicationCtrl.deselectAllSimFiles(analysis)">
                      <i class="fa fa-times"></i> Deselect All
                    </button>
                  </th>
                </thead>
                <tbody>
                  <tr ng-repeat="file in publicationCtrl.filterFiles(false, analysis, browser.listings[analysis.uuid]) | orderBy: ['type', 'path']">
                    <td>
                      <i class="fa {{file.icon()}}"></i>
                      <a ng-href="{{file.href}}" ng-click="onBrowse()($event, file)">
                        {{file.name}}
                      </a>
                    </td>
                  <td ng-if="file.format == 'folder'"> -- </td>
                    <td ng-if="!file.format == 'folder'">{{file.length|bytes}}</td>
                    <td>{{file.lastModified|date:"short"}}</td>
                    <td ng-if="browser.publishPipeline && browser.publishPipeline === 'select' ">
                      <button class="btn btn-success"
                              ng-if="publicationCtrl.isFileSelectedForSimPublication(analysis, file)"
                              ng-click="publicationCtrl.deselectFileForSimPublication(analysis, file)"
                              title="Selected">
                        <i class="fa fa-check"></i><span class="sr-only">Selected</span>
                      </button>
                      <button class="btn btn-danger"
                              ng-if="!publicationCtrl.isFileSelectedForSimPublication(analysis, file)"
                              ng-click="publicationCtrl.selectFileForSimPublication(analysis, file)"
                              title="Not Selected">
                        <i class="fa fa-times"></i><span class="sr-only">Not Selected</span>
                      </button>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
      <div id="data-{{analysis.uuid}}" class="collapse"
           ng-class="{'in': $index==0}">
      </div>
    </div>
  </div>

  <div ng-repeat="report in publicationCtrl.filterSimReports(browser.project.report_set) | orderBy: ['value.title', 'value.simulations.length']"
       ng-if="browser.showPreviewListing &&
              (!browser.publishPipeline ||
               browser.publishPipeline == 'select' ||
               browser.publishPipeline == 'review')"
       style="#fff;">
    <div class="dropdown entity-preview-header" id="details-{{report.uuid}}">
      <button class="btn btn-default btn-sm" data-toggle="collapse" data-target="#data-{{report.uuid}}"
              style="width:100%" ng-class="report.cssClasses()['text']">
        <span ng-if="!report.value.simulations.length">Report {{report.value.title}} </span>
        <span ng-if="report.value.simulations.length">Simulation Report {{report.value.title}} </span>
        <i class="fa dropdown-caret"></i>
      </button>
          <div id="data-{{report.uuid}}" class="collapse in">
            <div style="border:1px solid black; background:white; padding:5px; margin-bottom:15px;">
              <table  class="table table-bordered table-striped"
                      style="background-color: #fff;">
                <thead>
                  <th>Name</th>
                  <th>Size</th>
                  <th>Last modified</th>
                  <th ng-if="browser.publishPipeline && browser.publishPipeline === 'select'">
                    <button class="btn btn-default"
                            ng-if="publicationCtrl.filterFiles(false, report, browser.listings[report.uuid]) &&
                                   !(browser.publication.filesSelected[report.uuid]
                                   && browser.publication.filesSelected[report.uuid].length)"
                            ng-click="publicationCtrl.selectAllSimFiles(report)">
                      <i class="fa fa-check"></i> Select All
                    </button>
                    <button class="btn btn-default"
                            ng-if="browser.publication.filesSelected[report.uuid]
                                   && browser.publication.filesSelected[report.uuid].length"
                            ng-click="publicationCtrl.deselectAllSimFiles(report)">
                      <i class="fa fa-times"></i> Deselect All
                    </button>
                  </th>
                </thead>
                <tbody>
                  <tr ng-repeat="file in publicationCtrl.filterFiles(false, report, browser.listings[report.uuid]) | orderBy: ['type', 'path']">
                    <td>
                      <i class="fa {{file.icon()}}"></i>
                      <a ng-href="{{file.href}}" ng-click="onBrowse()($event, file)">
                        {{file.name}}
                      </a>
                    </td>
                  <td ng-if="file.format == 'folder'"> -- </td>
                    <td ng-if="!file.format == 'folder'">{{file.length|bytes}}</td>
                    <td>{{file.lastModified|date:"short"}}</td>
                    <td ng-if="browser.publishPipeline && browser.publishPipeline === 'select' ">
                      <button class="btn btn-success"
                              ng-if="publicationCtrl.isFileSelectedForSimPublication(report, file)"
                              ng-click="publicationCtrl.deselectFileForSimPublication(report, file)"
                              title="Selected">
                        <i class="fa fa-check"></i><span class="sr-only">Selected</span>
                      </button>
                      <button class="btn btn-danger"
                              ng-if="!publicationCtrl.isFileSelectedForSimPublication(report, file)"
                              ng-click="publicationCtrl.selectFileForSimPublication(report, file)"
                              title="Not Selected">
                        <i class="fa fa-times"></i><span class="sr-only">Not Selected</span>
                      </button>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
    </div>
  </div>

  <div class="meta-review" ng-if="browser.publishPipeline === 'meta'">
    <div class="meta-review header">
      <div class="col-sm-4"></div>
      <div class="col-sm-4" align="center">
        <p style="margin: 0px;">
          Proofread your metadata before publishing.
          <br>
          <span class="text-danger">* </span>
          <i>Indicates required metadata</i>
        </p>
      </div>
      <div class="col-sm-4" align="right">
        <a href="/help">Need Help?</a>
      </div>
    </div>
    <div class="content">
      <div class="content-wrapper" style="border-top: none">
        <h3 style="font-weight:500">Project Information</h3>
        <div class="meta-row">
          <div class="meta-row">
            <div class="attr pull-left">
              <span>Project Title </span>
              <span class="text-danger">*</span>
              <a href="#" ng-click="publicationCtrl.openEditProject()">
                <i class="fa fa-pencil-square-o"></i> Edit
              </a>
            </div>
            <div class="value pull-right">
              <span>{{browser.project.value.title}}</span>
            </div>
          </div>
          <div class="meta-row">
            <div class="attr pull-left">
              <span>Project Type </span>
              <span class="text-danger" style="text-transform:capitalize">*</span>
              <a href="#" ng-click="publicationCtrl.openEditProject()">
                <i class="fa fa-pencil-square-o"></i> Edit
              </a>
            </div>
            <div class="value pull-right">
              <span style="text-transform:capitalize">{{browser.project.value.projectType}}</span>
            </div>
          </div>
          <div class="meta-row">
            <div class="attr pull-left">
              <span>Participant Institutions </span>
              <span class="text-danger">*</span>
              <a href="#" ng-click="publicationCtrl.editInsts()">
                <i class="fa fa-pencil-square-o"></i> Edit
              </a>
            </div>
            <div class="value pull-right">
              <span ng-repeat="inst in browser.publication.institutions | filter: {_ui: {deleted: false }}" style="display:block;">
                <span class="text-danger" ng-if="publicationCtrl.isMissing(inst.label)">
                  <i class="fa fa-exclamation-circle"></i>
                </span>
                {{inst.label}}
              </span>
            </div>
          </div>
          <!--  -->
          <div class="meta-row">
            <div class="attr pull-left">
              <span>Team Members </span>
              <span class="text-danger">*</span>
              <a href="#" ng-click="publicationCtrl.editUsers()">
                <i class="fa fa-pencil-square-o"></i> Edit
              </a>
            </div>
            <div class="value pull-right">
              <div ng-repeat="user in browser.publication.users | orderBy: ['_ui.order', 'last_name'] | filter: {_ui: {deleted: false }}">
                <span class="text-danger" ng-if="publicationCtrl.isMissing(user.first_name)">
                  <i class="fa fa-exclamation-circle"></i>
                </span>
                <button class="btn btn-sm btn-link pull-left" title="Move order Up" ng-click="publicationCtrl.moveOrderUp($index, user, browser.publication.users)"
                  style="padding:0;">
                  <i class="fa fa-arrow-up"></i>
                </button>
                <button class="btn btn-sm btn-link pull-left" title="Move order Down" ng-click="publicationCtrl.moveOrderDown($index, user, browser.publication.users)"
                  style="padding:0;">
                  <i class="fa fa-arrow-down"></i>
                </button>
                <span style="padding-left:1em"> {{user.last_name}}, {{user.first_name}}</span>
              </div>
            </div>
          </div>
          <!--  -->
          <div class="meta-row">
            <div class="attr pull-left">
              <span>Project Description </span>
              <span class="text-danger">*</span>
              <a href="#" ng-click="publicationCtrl.openEditProject()">
                <i class="fa fa-pencil-square-o"></i> Edit
              </a>
            </div>
            <div class="value pull-right">
              <span>{{browser.project.value.description}}</span>
            </div>
          </div>
          <div class="meta-row">
            <div class="attr pull-left">
              <span>Funding Agency & Award Number </span>
              <span class="text-danger">*</span>
              <a href="#" ng-click="publicationCtrl.openEditProject()">
                <i class="fa fa-pencil-square-o"></i> Edit
              </a>
            </div>
            <div class="value pull-right">
              <span class="text-danger" ng-if="publicationCtrl.isMissing(browser.project.value.awardNumber)">
                <i class="fa fa-exclamation-circle"></i>
              </span>
              <span>{{browser.project.value.awardNumber}}</span>
            </div>
          </div>
          <div class="meta-row">
            <div class="attr pull-left">
              <span>Associated Projects </span>
              <!-- <span style="font-style: italic; font-weight: normal"> Required if available</span> -->
              <a href="#" ng-click="publicationCtrl.openEditProject()">
                <i class="fa fa-pencil-square-o"></i> Edit
              </a>
            </div>
            <div class="value pull-right">
              <span class="value pull-right" ng-repeat="asoc in browser.project.value.associatedProjects">
                {{asoc}}
              </span>
            </div>
          </div>
          <div class="meta-row">
            <div class="attr pull-left">
              <span>Rights </span>
              <span class="text-danger">*</span>
            </div>
            <div class="value pull-right">
              <span>ODC-BY 1.0 [
                <a href="http://opendatacommons.org/licenses/by/1-0/"> http://opendatacommons.org/licenses/by/1-0/</a>]</span>
            </div>
          </div>
          <div class="meta-row">
            <div class="attr pull-left">
              <span>Keywords </span>
              <span class="text-danger">*</span>
              <a href="#" ng-click="publicationCtrl.openEditProject()">
                <i class="fa fa-pencil-square-o"></i> Edit
              </a>
              <br/>
            </div>
            <div class="value pull-right">
              <span ng-repeat="keyword in browser.project.value.keywords.split(',')" style="display:block;">
                <span class="text-danger" ng-if="publicationCtrl.isMissing(keyword)">
                  <i class="fa fa-exclamation-circle"></i>
                </span>
                {{keyword}}
              </span>
              <br/>
            </div>
          </div>
          <div class="meta-row">
            <span class="attr pull-left">Date of Publication
              <!-- <span style="font-style: italic; font-weight: normal"> Added by system</span> -->
            </span>
            <span class="value pull-right">{{browser.project.dateOfPublication()}}</span>
          </div>
          <div class="meta-row">
            <div class="attr pull-left">
              <span>Publisher
                <!-- <span style="font-style: italic; font-weight: normal"> Added by system</span> -->
              </span>
            </div>
            <div class="value pull-right">
              <span>DesignSafe-CI</span>
            </div>
          </div>
          <div class="meta-row">
          </div>
        </div>
        <div class="content-wrapper" style="border-top: none">
          <h3 ng-if="publicationCtrl.isMissing(browser.publication.simulations)" class="text-danger" style="font-weight:500">Simulation Information
            <i class="fa fa-exclamation-circle"></i>
          </h3>
          <span ng-if="publicationCtrl.isMissing(browser.publication.simulations)" class="text-danger">You must include the details of your simulation</span>
        </div>
        <div class="content-wrapper" ng-repeat="sim in browser.publication.simulations | orderBy: ['_ui.order', 'value.title']">
          <h3 style="font-weight:500">Simulation Information</h3>
          <div class="meta-row">
            <div class="attr pull-left">
              <span>Simulation Title</span>
              <span class="text-danger">*</span>
              <a href="#" ng-click="publicationCtrl.openEditSimulations()">
                <i class="fa fa-pencil-square-o"></i> Edit
              </a>
            </div>
            <div class="value pull-right">
              <span class="text-danger" ng-if="publicationCtrl.isMissing(sim.value.title)">
                <i class="fa fa-exclamation-circle"></i>
              </span>
              <span>{{sim.value.title}}</span>
            </div>
          </div>
          <div class="meta-row">
            <div class="attr pull-left">
              <span>Simulation Type</span>
              <span class="text-danger">*</span>
              <a href="#" ng-click="publicationCtrl.openEditSimulations()">
                <i class="fa fa-pencil-square-o"></i> Edit
              </a>
            </div>
            <div class="value pull-right">
              <span class="text-danger" ng-if="publicationCtrl.isMissing(sim.value.simulationType)">
                <i class="fa fa-exclamation-circle"></i>
              </span>
              <span ng-if="sim.value.simulationType !== 'Other'">{{sim.value.simulationType}}</span>
              <span ng-if="sim.value.simulationType === 'Other'">{{sim.value.simulationTypeOther}}</span>
            </div>
          </div>
          <div class="meta-row">
            <div class="attr pull-left">
              <span>Authors</span>
              <span class="text-danger">*</span>
            </div>
            <div class="value pull-right">
              <div ng-repeat="user in publicationCtrl.filterUsers(sim.value.authors,
                                        browser.publication.users) | orderBy: ['_ui.order', 'last_name']">
                <span class="text-danger" ng-if="publicationCtrl.isMissing(user.first_name)">
                  <i class="fa fa-exclamation-circle"></i>
                </span>
                <span>
                  {{user.last_name}}, {{user.first_name}}
                </span>
              </div>
            </div>
          </div>
          <div class="meta-row">
            <div class="attr pull-left">
              <span>Simulation Description</span>
              <span class="text-danger">*</span>
              <a href="#" ng-click="publicationCtrl.openEditSimulations()">
                <i class="fa fa-pencil-square-o"></i> Edit
              </a>
            </div>
            <div class="value pull-right">
              <span class="text-danger" ng-if="publicationCtrl.isMissing(sim.value.description)">
                <i class="fa fa-exclamation-circle"></i>
              </span>
              <span>{{sim.value.description}}</span>
            </div>
          </div>
          <div class="meta-row">
            <div class="attr pull-left">
              <span>Simulation Models</span>
              <span class="text-danger">*</span>
              <a href="#" ng-click="publicationCtrl.openEditCategories([])">
                <i class="fa fa-pencil-square-o"></i> Edit
              </a>
            </div>
            <div class="value pull-right">
              <span ng-repeat="model in publicationCtrl.filterSimulationModels(browser.project.getRelated('model_set', sim.uuid), sim)"
                style="display:block; color:#0567CC;">
                <span class="text-danger" ng-if="publicationCtrl.isMissing(model.value.title)">
                  <i class="fa fa-exclamation-circle"></i>
                </span>
                {{model.value.title}}
                <div style="color: black;">
                  <span class="text-danger" ng-if="publicationCtrl.isMissing(model.value.description)">
                    <i class="fa fa-exclamation-circle"></i>
                  </span>
                  {{model.value.description}}
                </div>
              </span>
              <br/>
            </div>
          </div>
          <div class="meta-row">
            <div class="attr pull-left">
              <span>Input</span>
              <span class="text-danger">*</span>
              <a href="#" ng-click="publicationCtrl.openEditCategories([])">
                <i class="fa fa-pencil-square-o"></i> Edit
              </a>
            </div>
            <div class="value pull-right">
              <span ng-repeat="simInput in publicationCtrl.filterSimulationInputs(browser.project.getRelated('input_set', sim.uuid), sim)"
                style="display:block; color:#2EA89A;">
                <span class="text-danger" ng-if="publicationCtrl.isMissing(simInput.value.title)">
                  <i class="fa fa-exclamation-circle"></i>
                </span>
                {{simInput.value.title}}
                <div style="color: black;">
                  <!-- <span class="text-danger" ng-if="publicationCtrl.isMissing(simInput.value.description)">
                    <i class="fa fa-exclamation-circle"></i>
                  </span> -->
                  {{simInput.value.description}}
                </div>
              </span>
              <br/>
            </div>
          </div>
          <div class="meta-row">
            <div class="attr pull-left">
              <span>Output</span>
              <span class="text-danger">*</span>
              <a href="#" ng-click="publicationCtrl.openEditCategories([])">
                <i class="fa fa-pencil-square-o"></i> Edit
              </a>
            </div>
            <div class="value pull-right">
              <span ng-repeat="simOutput in publicationCtrl.filterSimulationOutputs(browser.project.getRelated('output_set', sim.uuid), sim)"
                style="display:block; color:#D04348;">
                <span class="text-danger" ng-if="publicationCtrl.isMissing(simOutput.value.title)">
                  <i class="fa fa-exclamation-circle"></i>
                </span>
                {{simOutput.value.title}}
                <div style="color: black;">
                  <!-- <span class="text-danger" ng-if="publicationCtrl.isMissing(simOutput.value.description)">
                    <i class="fa fa-exclamation-circle"></i>
                  </span> -->
                  {{simOutput.value.description}}
                </div>
              </span>
              <br/>
            </div>
          </div>
          <div class="meta-row">
            <div class="attr pull-left">
              <span>Integrated Data Analysis</span>
              <!-- <span class="text-danger">*</span> -->
              <a href="#" ng-click="publicationCtrl.openEditCategories([])">
                <i class="fa fa-pencil-square-o"></i> Edit
              </a>
            </div>
            <div class="value pull-right">
              <span ng-repeat="intAnalysis in browser.project.analysis_set"
                style="display:block;">
                <!-- <span class="text-danger" ng-if="publicationCtrl.isMissing(intAnalysis.value.title)">
                  <i class="fa fa-exclamation-circle"></i>
                </span> -->
                <span ng-if="!publicationCtrl.isMissing(intAnalysis.value.simOutputs)">{{intAnalysis.value.title}}</span>
                <div style="color: black;">
                  <span class="text-danger" ng-if="publicationCtrl.isMissing(intAnalysis.value.description)">
                    <i class="fa fa-exclamation-circle"></i>
                  </span>
                  <span ng-if="!publicationCtrl.isMissing(intAnalysis.value.simOutputs)">{{intAnalysis.value.description}}</span>
                </div>
                <!-- List asociated sim output with each analysis... -->
              </span>
              <br/>
            </div>
          </div>
          <div class="meta-row">
            <div class="attr pull-left">
              <span>Integrated Reports</span>
              <!-- <span class="text-danger">*</span> -->
              <a href="#" ng-click="publicationCtrl.openEditCategories([])">
                <i class="fa fa-pencil-square-o"></i> Edit
              </a>
            </div>
            <div class="value pull-right">
              <span ng-repeat="intReport in browser.project.report_set"
                style="display:block;">
                <!-- <span class="text-danger" ng-if="publicationCtrl.isMissing(intReport.value.title) && !publicationCtrl.isMissing(intReport.value.simOutputs)">
                  <i class="fa fa-exclamation-circle"></i>
                </span> -->
                <span ng-if="!publicationCtrl.isMissing(intReport.value.simOutputs)">{{intReport.value.title}}</span>
                <div style="color: black;">
                  <span class="text-danger" ng-if="publicationCtrl.isMissing(intReport.value.description) && !publicationCtrl.isMissing(intReport.value.simOutputs)">
                    <i class="fa fa-exclamation-circle"></i>
                  </span>
                  <span ng-if="!publicationCtrl.isMissing(intReport.value.simOutputs)">{{intReport.value.description}}</span>
                </div>
                <!-- List asociated sim output with each report... -->
              </span>
              <br/>
            </div>
          </div>
          <div class="meta-row">
            <div class="attr pull-left">
              <span>Date of Publication</span>
            </div>
            <div class="value pull-right">
              <span>{{browser.project.dateOfPublication()}}</span>
            </div>
          </div>
        </div>
        <!-- analysis -->
        <div class="content-wrapper" style="border-top: none">
          <h3 style="font-weight:500" ng-if="publicationCtrl.isMissing(publicationCtrl.filterSimAnalysis(browser.project.analysis_set))">Analysis Information</h3>
          <span ng-if="publicationCtrl.isMissing(publicationCtrl.filterSimReports(browser.project.report_set))">It is recommended to include an Analysis.</span>
        </div>
        <!-- <div class="content-wrapper" style="border-top: none">
          <h3 style="font-weight:500" class="text-danger" ng-if="publicationCtrl.isMissing(publicationCtrl.filterSimAnalysis(browser.project.analysis_set))">Analysis Information
              <i class="fa fa-exclamation-circle"></i>
          </h3>
          <span class="text-danger" ng-if="publicationCtrl.isMissing(publicationCtrl.filterSimAnalysis(browser.project.analysis_set))">You must include an Analysis.</span>
        </div> -->
        <div class="content-wrapper" ng-repeat="analysis in publicationCtrl.filterSimAnalysis(browser.project.analysis_set) | orderBy: ['_ui.order', 'value.title']">
          <h3 style="font-weight:500">Analysis Information</h3>
          <div class="meta-row">
            <div class="attr pull-left">
              <span>Analysis Title</span>
              <span class="text-danger">*</span>
              <a href="#" ng-click="publicationCtrl.openEditCategories([])">
                <i class="fa fa-pencil-square-o"></i> Edit
              </a>
            </div>
            <div class="value pull-right">
              <span class="text-danger" ng-if="publicationCtrl.isMissing(analysis.value.title)">
                <i class="fa fa-exclamation-circle"></i>
              </span>
              <span>{{analysis.value.title}}</span>
            </div>
          </div>
          <div class="meta-row">
            <div class="attr pull-left">
              <span>Description</span>
              <span class="text-danger">*</span>
              <a href="#" ng-click="publicationCtrl.openEditCategories([])">
                <i class="fa fa-pencil-square-o"></i> Edit
              </a>
            </div>
            <div class="value pull-right">
              <span class="text-danger" ng-if="publicationCtrl.isMissing(analysis.value.description)">
                <i class="fa fa-exclamation-circle"></i>
              </span>
              <span>{{analysis.value.description}}</span>
            </div>
          </div>
          <div class="meta-row">
              <div class="attr pull-left">
                <span>Referenced Data</span>
                <a href="#" ng-click="publicationCtrl.openEditCategories([])">
                  <i class="fa fa-pencil-square-o"></i> Edit
                </a>
              </div>
              <div class="value pull-right">
                <span class="text-danger" ng-if="publicationCtrl.isMissing(analysis.value.referencedoi)">
                  <i class="fa fa-exclamation-circle"></i>
                </span>
                <span>{{analysis.value.reference}} {{analysis.value.referencedoi}}</span>
              </div>
            </div>
          <div class="meta-row">
            <div class="attr pull-left">
              <span>Date of Publication</span>
            </div>
            <div class="value pull-right">
              <span>{{browser.project.dateOfPublication()}}</span>
            </div>
          </div>
        </div>
        <div class="content-wrapper" style="border-top: none">
          <h3 style="font-weight:500" ng-if="publicationCtrl.isMissing(publicationCtrl.filterSimReports(browser.project.report_set))">Report Information</h3>
          <span ng-if="publicationCtrl.isMissing(publicationCtrl.filterSimReports(browser.project.report_set))">It is recommended to include a Report.</span>
        </div>
        <div class="content-wrapper" ng-repeat="report in publicationCtrl.filterSimReports(browser.project.report_set) | orderBy: ['_ui.order', 'value.title']">
          <h3 style="font-weight:500">Report Information</h3>
          <div class="meta-row">
            <div class="attr pull-left">
              <span>Report Title</span>
              <span class="text-danger">*</span>
              <a href="#" ng-click="publicationCtrl.openEditCategories([])">
                <i class="fa fa-pencil-square-o"></i> Edit
              </a>
            </div>
            <div class="value pull-right">
              <span class="text-danger" ng-if="publicationCtrl.isMissing(report.value.title)">
                <i class="fa fa-exclamation-circle"></i>
              </span>
              <span>{{report.value.title}}</span>
            </div>
          </div>
          <!-- <div class="meta-row">
            <div class="attr pull-left">
              <span>Report Description</span>
              <span class="text-danger">*</span>
              <a href="#" ng-click="publicationCtrl.openEditCategories([])">
                <i class="fa fa-pencil-square-o"></i> Edit
              </a>
            </div>
            <div class="value pull-right">
              <span class="text-danger" ng-if="publicationCtrl.isMissing(report.value.description)">
                <i class="fa fa-exclamation-circle"></i>
              </span>
              <span>{{report.value.description}}</span>
            </div>
          </div> -->
        </div>
      </div>
    </div>
  </div>
</div> <!-- END SIMULATION PUBLISHING STEPS -->




<div class="experimental-publishing-steps" ng-if="browser.project.value.projectType == 'experimental'">
  <div ng-repeat="experiment in publicationCtrl.filterExperiments(browser.project.experiment_set) | orderBy: 'value.title'"
    ng-if="browser.showPreviewListing &&
        (!browser.publishPipeline ||
        browser.publishPipeline == 'select' ||
        browser.publishPipeline == 'review')" style="background:#fff;">

    <div class="dropdown entity-preview-header" id="details-{{experiment.uuid}}">
      <button class="btn btn-default btn-sm " data-toggle="collapse" data-target="#data-{{experiment.uuid}}" style="width:100%;">
        Experiment {{experiment.value.title}}
        <i class="fa dropdown-caret"></i>
      </button>
      <div id="data-{{experiment.uuid}}" class="collapse" ng-class="{'in': $index==0}">
        <div style="border:1px solid black; background:white; margin-bottom:15px;">
          <div style="padding:5px;">
            <h3 style="margin-top:0">{{experiment.value.title}}</h3>
            <p style="font-weight:bold;">Description</p>
            <p>{{experiment.value.description}}</p>
          </div>
          <div style="width:49%; vertical-align:top; display:inline-block;">
            <div>
              <span style="font-weight:bold; display:inline-block; width:150px;"> Date of Publication: </span> (Appears when published)
            </div>
            <div>
              <span style="font-weight:bold; display:inline-block; width:150px;"> DOI: </span> (Appears when published)
            </div>
            <div>
              <span style="font-weight:bold; display:inline-block; width:150px;"> Experimental Facility: </span>
              {{experiment.getEF(browser.project.value.projectType, experiment.value.experimentalFacility).label}}
            </div>
            <div>
              <span style="font-weight:bold; display:inline-block; width:150px;"> Experiment Type: </span>
              <span style="text-transform:capitalize;">{{experiment.getExpType(experiment.value.experimentalFacility, experiment.value.experimentType).label}}</span>
            </div>
            <div>
              <span style="font-weight:bold; display:inline-block; width:150px;"> Equipment Type: </span>
              <span style="text-transform:capitalize;">{{experiment.getET(experiment.value.experimentalFacility, experiment.value.equipmentType).label}}</span>
            </div>
          </div>
          <div style="width:49%; vertical-align:top; display:inline-block;">
            <div>
              <span style="font-weight:bold; display:inline-block; width:100px;">Authors: </span>
              <span ng-repeat="user in publicationCtrl.filterUsers(experiment.value.authors,
                               browser.publication.users) | orderBy: ['_ui.order', 'last_name']"> {{user.last_name}}, {{user.first_name}};
              </span>
              <div ng-if="browser.project.getRelated('report_set', experiment.uuid) &&
                          browser.publication.filesSelected[browser.project.getRelated('report_set', experiment.uuid)[0].uuid].length">
                <span style="font-weight:bold; display:inline-block; width:100px;">Report: </span>
                <a href="#details-{{browser.project.getRelated('report_set', experiment.uuid)[0].uuid}}" class="btn btn-link">
                  <span style="font-weight:bold;">{{browser.project.getRelated('report_set', experiment.uuid)[0].value.title}}</span>
                </a>
              </div>
            </div>
          </div>
          <div ng-if="!publicationCtrl.filterEvents(browser.project.getRelated('event_set', experiment.uuid), experiment).length" class="bg-info"
            style="padding:10px; margin-bottom:10px; border-bottom:1px solid black;">
            This Experiment has no Events.
          </div>
          <div ng-repeat="event in all_events = publicationCtrl.filterEvents(browser.project.getRelated('event_set', experiment.uuid), experiment) | orderBy: ['_ui.order', 'value.title']"
            style="margin-bottom:10px;">
            <div style="padding:3px;">
              <span class="ds-text-red folder-tick">Event Data: {{event.value.title}} </span>
              <span style="color:light-gray">Link to: </span>
              <a class="ds-text-blue" href="#details-{{browser.project.getRelatedByUuid(event.value.modelConfigs[0]).uuid}}" data-toggle="collapse"
                data-target="#files-{{browser.project.getRelatedByUuid(event.value.modelConfigs[0]).uuid}}">
                Model Configuration
              </a>
              <a class="ds-text-green" href="#details-{{browser.project.getRelatedByUuid(event.value.sensorLists[0]).uuid}}" data-toggle="collapse"
                data-target="#files-{{browser.project.getRelatedByUuid(event.value.sensorLists[0]).uuid}}">
                Sensor List
              </a>
            </div>
            <div style="position:absolute; left:-110px; margin-top:-20px; width:110px;">
              <div style="border-bottom:1px solid lightgrey;">
                <a class="ds-text-red" ng-click="openPreviewTree()($event, event.uuid)" href="#">
                  Relations
                </a>
              </div>
              <div>
                <a class="ds-text-blue" href="" ng-click="openPreviewTree()($event, event.value.modelConfigs[0])">
                  {{browser.project.getRelatedByUuid(event.value.modelConfigs[0]).value.title}}
                </a>
              </div>
              <div>
                <a class="ds-text-green" href="" ng-click="openPreviewTree()($event, event.value.sensorLists[0])">
                  {{browser.project.getRelatedByUuid(event.value.sensorLists[0]).value.title}}
                </a>
              </div>
            </div>
            <div style="margin-left:-5px; padding-left:5px; margin-top:-11px; padding-top:7px; border-left:1px solid #ccc; border-radius:5px 0px 0px 5px; overflow:scroll;">
              <table class="table table-bordered table-striped"
                     style="background-color: #fff;">
                <thead>
                  <th>Name</th>
                  <th>Size</th>
                  <th>Last modified</th>
                  <th ng-if="browser.publishPipeline && browser.publishPipeline === 'select'">
                    <button class="btn btn-default" ng-if="publicationCtrl.filterFiles(experiment, event, browser.listings[event.uuid]).length &&
                                   !(browser.publication.filesSelected[experiment.uuid][event.uuid]
                                   && browser.publication.filesSelected[experiment.uuid][event.uuid].length)" ng-click="publicationCtrl.selectAllFiles(experiment, event)">
                      <i class="fa fa-check"></i> Select All
                    </button>
                    <button class="btn btn-default" ng-if="browser.publication.filesSelected[experiment.uuid][event.uuid]
                                   && browser.publication.filesSelected[experiment.uuid][event.uuid].length" ng-click="publicationCtrl.deselectAllFiles(experiment, event)">
                      <i class="fa fa-times"></i> Deselect All
                    </button>
                  </th>
                </thead>
                <tbody>
                  <tr ng-repeat="file in publicationCtrl.filterFiles(experiment, event, browser.listings[event.uuid]) | orderBy: ['type', 'path']">
                    <td>
                      <i class="fa {{file.icon()}}"></i>
                      <a ng-href="{{file.href}}" ng-click="onBrowse()($event, file)">
                        {{file.name}}
                      </a>
                    </td>
                    <td>{{file.length|bytes}}</td>
                    <td>{{file.lastModified|date:"short"}}</td>
                    <td ng-if="browser.publishPipeline && browser.publishPipeline === 'select' ">
                      <button class="btn btn-success" ng-if="publicationCtrl.isFileSelectedForPublication(experiment, event, file)" ng-click="publicationCtrl.deselectFileForPublication(experiment, event, file)"
                        title="Selected">
                        <i class="fa fa-check"></i>
                        <span class="sr-only">Selected</span>
                      </button>
                      <button class="btn btn-danger" ng-if="!publicationCtrl.isFileSelectedForPublication(experiment, event, file)" ng-click="publicationCtrl.selectFileForPublication(experiment, event, file)"
                        title="Not Selected">
                        <i class="fa fa-times"></i>
                        <span class="sr-only">Not Selected</span>
                      </button>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="project-preview-entities-details" ng-if="browser.showPreviewListing &&
         (!browser.publishPipeline ||
         browser.publishPipeline == 'select' ||
          browser.publishPipeline == 'review')" style="background:#fff;">

    <div ng-repeat="modelConfig in browser.project.modelconfig_set | orderBy: 'value.title'" ng-if="!browser.publishPipeline ||
               browser.publishPipeline === 'select'">
      <div class="dropdown entity-preview-header" id="details-{{modelConfig.uuid}}">
        <button class="btn btn-sm btn-default collapsed ds-text-blue" data-toggle="collapse" data-target="#files-{{modelConfig.uuid}}"
          style="width:100%;">
          Model Config {{modelConfig.value.title}}
          <i class="fa dropdown-caret"></i>
        </button>
        <div id="files-{{modelConfig.uuid}}" class="collapse">
          <table class="table table-bordered table-striped" style="background-color: #fff;">
            <thead>
              <th>Name</th>
              <th>Size</th>
              <th>Last modified</th>
            </thead>
            <tbody>
              <tr ng-repeat="file in browser.listings[modelConfig.uuid] | orderBy: ['type', 'path']">
                <td>
                  <i class="fa {{file.icon()}}"></i>
                  <a ng-href="{{file.href}}" ng-click="onBrowse()($event, file)">
                    {{file.name}}
                  </a>
                </td>
                <td ng-if="file.format == 'folder'"> -- </td>
                <td ng-if="file.format == 'raw'">{{file.length|bytes}}</td>
                <td>{{file.lastModified|date:"short"}}</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <div ng-repeat="sensorList in browser.project.sensorlist_set | orderBy: 'value.title'" ng-if="!browser.publishPipeline ||
                browser.publishPipeline === 'select'">
      <div class="dropdown entity-preview-header" id="details-{{sensorList.uuid}}">
        <button class="btn btn-sm btn-default collapsed ds-text-green" data-toggle="collapse" data-target="#files-{{sensorList.uuid}}"
          style="width:100%;">
          Sensor Info {{sensorList.value.title}}
          <i class="fa dropdown-caret"></i>
        </button>
        <div id="files-{{sensorList.uuid}}" class="collapse">
          <table class="table table-bordered table-striped" style="background-color: #fff;">
            <thead>
              <th>Name</th>
              <th>Size</th>
              <th>Last modified</th>
            </thead>
            <tbody>
              <tr ng-repeat="file in browser.listings[sensorList.uuid] | orderBy: ['type', 'path']">
                <td>
                  <i class="fa {{file.icon()}}"></i>
                  <a ng-href="{{file.href}}" ng-click="onBrowse()($event, file)">
                    {{file.name}}
                  </a>
                </td>
                <td ng-if="file.format == 'folder'"> -- </td>
                <td ng-if="file.format == 'raw'">{{file.length|bytes}}</td>
                <td>{{file.lastModified|date:"short"}}</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <div ng-repeat="analysis in browser.project.analysis_set | orderBy: 'value.title'" ng-if="browser.publishPipeline != 'meta' &&
                browser.publishPipeline != 'agreement'">
      <div class="entity-wrapper" ng-if="publicationCtrl.filterFiles(analysis, false, browser.listings[analysis.uuid]).length">
        <div class="dropdown entity-preview-header" id="details-{{analysis.uuid}}">
          <button class="btn btn-default btn-sm ds-text-light-blue" data-toggle="collapse" data-target="#files-{{analysis.uuid}}" style="width:100%;">
            Analysis {{analysis.value.title}}
            <i class="fa dropdown-caret"></i>
          </button>
          <div id="files-{{analysis.uuid}}" class="collapse in">
            <div style="border:1px solid black; background:white; padding:5px; margin-bottom:15px;">
              <div style="width:50%; display:inline-block;">
                <h3 style="margin-top:0;">{{analysis.value.title}}</h3>
                <div style="padding:5px; margin:5px 0px; height:60px; overflow:hidden; word-wrap:overflow;">
                  <p style="overflow:hidden; display:block; height:20px;">
                    <span style="font-weight:bold;">Description: </span>{{analysis.value.description}}
                  </p>
                  <button class="btn btn-link btn-sm" ng-click="publicationCtrl.showText(analysis.value.description)">
                    <i class="fa fa-external-link"></i> Show
                  </button>
                </div>
              </div>
              <table class="table table-bordered table-striped" style="background-color: #fff;">
                <thead>
                  <th>Name</th>
                  <th>Size</th>
                  <th>Last modified</th>
                  <th ng-if="browser.publishPipeline && browser.publishPipeline === 'select'">
                    <button class="btn btn-default" ng-if="publicationCtrl.filterFiles(analysis, false, browser.listings[analysis.uuid]) &&
                                   !(browser.publication.filesSelected[analysis.uuid]
                                   && browser.publication.filesSelected[analysis.uuid].length)" ng-click="publicationCtrl.selectAllFiles(analysis)">
                      <i class="fa fa-check"></i> Select All
                    </button>
                    <button class="btn btn-default" ng-if="browser.publication.filesSelected[analysis.uuid]
                                   && browser.publication.filesSelected[analysis.uuid].length" ng-click="publicationCtrl.deselectAllFiles(analysis)">
                      <i class="fa fa-times"></i> Deselect All
                    </button>
                  </th>
                </thead>
                <tbody>
                  <tr ng-repeat="file in publicationCtrl.filterFiles(analysis, false, browser.listings[analysis.uuid]) | orderBy: ['type', 'path']">
                    <td>
                      <i class="fa {{file.icon()}}"></i>
                      <a ng-href="{{file.href}}" ng-click="onBrowse()($event, file)">
                        {{file.name}}
                      </a>
                    </td>
                    <td ng-if="file.format == 'folder'"> -- </td>
                    <td ng-if="!file.format == 'folder'">{{file.length|bytes}}</td>
                    <td>{{file.lastModified|date:"short"}}</td>
                    <td ng-if="browser.publishPipeline && browser.publishPipeline === 'select' ">
                      <button class="btn btn-success" ng-if="publicationCtrl.isFileSelectedForPublication(analysis, false, file)" ng-click="publicationCtrl.deselectFileForPublication(analysis, false, file)"
                        title="Selected">
                        <i class="fa fa-check"></i>
                        <span class="sr-only">Selected</span>
                      </button>
                      <button class="btn btn-danger" ng-if="!publicationCtrl.isFileSelectedForPublication(analysis, false, file)" ng-click="publicationCtrl.selectFileForPublication(analysis, false, file)"
                        title="Not Selected">
                        <i class="fa fa-times"></i>
                        <span class="sr-only">Not Selected</span>
                      </button>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div ng-repeat="report in browser.project.report_set | orderBy: 'value.title'">
      <div class="entity-wrapper" ng-if="publicationCtrl.filterFiles(report, false, browser.listings[report.uuid]).length">
        <div class="dropdown entity-preview-header" id="details-{{report.uuid}}">
          <button class="btn btn-default btn-sm" data-toggle="collapse" data-target="#files-{{report.uuid}}" style="width:100%;">
            Report {{report.value.title}}
            <i class="fa dropdown-caret"></i>
          </button>
          <div id="files-{{report.uuid}}" class="collapse in">
            <div style="border:1px solid black; background:white; padding:5px; margin-bottom:15px;">
              <div style="width:50%; display:inline-block;">
                <h3 style="margin-top:0;">{{report.value.title}}</h3>
                <div style="padding:5px; margin:5px 0px; height:60px; overflow:hidden; word-wrap:overflow;">
                  <p style="overflow:hidden; display:block; height:20px;">
                    <span style="font-weight:bold;">Description: </span>{{report.value.description}}
                  </p>
                  <button class="btn btn-link btn-sm" ng-click="publicationCtrl.showText(analysis.value.description)">
                    <i class="fa fa-external-link"></i> Show
                  </button>
                </div>
              </div>
              <table class="table table-bordered table-striped" style="background-color: #fff;">
                <thead>
                  <th>Name</th>
                  <th>Size</th>
                  <th>Last modified</th>
                  <th ng-if="browser.publishPipeline && browser.publishPipeline === 'select'">
                    <button class="btn btn-default" ng-if="publicationCtrl.filterFiles(report, false, browser.listings[report.uuid]) &&
                                   !(browser.publication.filesSelected[report.uuid]
                                   && browser.publication.filesSelected[report.uuid].length)" ng-click="publicationCtrl.selectAllFiles(report)">
                      <i class="fa fa-check"></i> Select All
                    </button>
                    <button class="btn btn-default" ng-if="browser.publication.filesSelected[report.uuid]
                                   && browser.publication.filesSelected[report.uuid].length" ng-click="publicationCtrl.deselectAllFiles(report)">
                      <i class="fa fa-times"></i> Deselect All
                    </button>
                  </th>
                </thead>
                <tbody>
                  <tr ng-repeat="file in publicationCtrl.filterFiles(report, false, browser.listings[report.uuid]) | orderBy: ['type', 'path']">
                    <td>
                      <i class="fa {{file.icon()}}"></i>
                      <a ng-href="{{file.href}}" ng-click="onBrowse()($event, file)">
                        {{file.name}}
                      </a>
                    </td>
                    <td ng-if="file.format == 'folder'"> -- </td>
                    <td ng-if="file.format== 'raw'">{{file.length|bytes}}</td>
                    <td>{{file.lastModified|date:"short"}}</td>
                    <td ng-if="browser.publishPipeline && browser.publishPipeline === 'select' ">
                      <button class="btn btn-success" ng-if="publicationCtrl.isFileSelectedForPublication(report, false, file)" ng-click="publicationCtrl.deselectFileForPublication(report, false, file)"
                        title="Selected">
                        <i class="fa fa-check"></i>
                        <span class="sr-only">Selected</span>
                      </button>
                      <button class="btn btn-danger" ng-if="!publicationCtrl.isFileSelectedForPublication(report, false, file)" ng-click="publicationCtrl.selectFileForPublication(report, false, file)"
                        title="Not Selected">
                        <i class="fa fa-times"></i>
                        <span class="sr-only">Not Selected</span>
                      </button>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <form name='metaForm'>
    <div class="meta-review" ng-if="browser.publishPipeline === 'meta'">
      <div class="meta-review header">
        <div class="col-sm-4"></div>
        <div class="col-sm-4" align="center">
          <p style="margin: 0px;">
            Proofread your metadata before publishing.
            <br>
            <span class="text-danger">* </span>
            <i>Indicates required metadata</i>
          </p>
        </div>
        <div class="col-sm-4" align="right">
          <a href="/help">Need Help?</a>
        </div>
      </div>
      <div class="content">
        <div class="content-wrapper" style="border-top: none">
          <h3 style="font-weight:500">Project Information</h3>
          <div class="meta-row">
            <div class="meta-row">
              <div class="attr pull-left">
                <span>Project Title </span>
                <span class="text-danger">*</span>
                <a href="#" ng-click="publicationCtrl.openEditProject()">
                  <i class="fa fa-pencil-square-o"></i> Edit
                </a>
              </div>
              <div class="value pull-right">
                <span>{{browser.project.value.title}}</span>
              </div>
            </div>
            <div class="meta-row">
              <div class="attr pull-left">
                <span>Project Type </span>
                <span class="text-danger" style="text-transform:capitalize">*</span>
                <a href="#" ng-click="publicationCtrl.openEditProject()">
                  <i class="fa fa-pencil-square-o"></i> Edit
                </a>
              </div>
              <div class="value pull-right">
                <span style="text-transform:capitalize">{{browser.project.value.projectType}}</span>
              </div>
            </div>
            <div class="meta-row">
              <div class="attr pull-left">
                <span>Participant Institutions </span>
                <span class="text-danger">*</span>
                <a href="#" ng-click="publicationCtrl.editInsts()">
                  <i class="fa fa-pencil-square-o"></i> Edit
                </a>
              </div>
              <div class="value pull-right">
                <span ng-repeat="inst in browser.publication.institutions | filter: {_ui: {deleted: false }}" style="display:block;">
                  <span class="text-danger" ng-if="publicationCtrl.isMissing(inst.label)">
                    <i class="fa fa-exclamation-circle"></i>
                  </span>
                  {{inst.label}}
                </span>
              </div>
            </div>
            <div class="meta-row">
              <div class="attr pull-left">
                <span>Team Members </span>
                <span class="text-danger">*</span>
                <a href="#" ng-click="publicationCtrl.editUsers()">
                  <i class="fa fa-pencil-square-o"></i> Edit
                </a>
              </div>
              <div class="value pull-right">
                <div ng-repeat="user in browser.publication.users | orderBy: ['_ui.order', 'last_name'] | filter: {_ui: {deleted: false }}">
                  <button class="btn btn-sm btn-link pull-left" title="Move order Up" ng-click="publicationCtrl.moveOrderUp($index, user, browser.publication.users)"
                    style="padding:0;">
                    <i class="fa fa-arrow-up"></i>
                  </button>
                  <button class="btn btn-sm btn-link pull-left" title="Move order Down" ng-click="publicationCtrl.moveOrderDown($index, user, browser.publication.users)"
                    style="padding:0;">
                    <i class="fa fa-arrow-down"></i>
                  </button>
                  <span class="text-danger" ng-if="publicationCtrl.isMissing(user.first_name)">
                    <i class="fa fa-exclamation-circle"></i>
                  </span>
                  <span style="padding-left:1em"> {{user.last_name}}, {{user.first_name}}</span>
                </div>
              </div>
            </div>
            <div class="meta-row">
              <div class="attr pull-left">
                <span>Project Description </span>
                <span class="text-danger">*</span>
                <a href="#" ng-click="publicationCtrl.openEditProject()">
                  <i class="fa fa-pencil-square-o"></i> Edit
                </a>
              </div>
              <div class="value pull-right">
                <span>{{browser.project.value.description}}</span>
              </div>
            </div>
            <div class="meta-row">
              <div class="attr pull-left">
                <span>Funding Agency & Award Number </span>
                <span class="text-danger">*</span>
                <a href="#" ng-click="publicationCtrl.openEditProject()">
                  <i class="fa fa-pencil-square-o"></i> Edit
                </a>
              </div>
              <div class="value pull-right">
                <span>{{browser.project.value.awardNumber}}</span>
              </div>
            </div>
            <div class="meta-row">
              <div class="attr pull-left">
                <span>Associated Projects </span>
                <!-- <span style="font-style: italic; font-weight: normal"> Required if available</span> -->
                <a href="#" ng-click="publicationCtrl.openEditProject()">
                  <i class="fa fa-pencil-square-o"></i> Edit
                </a>
              </div>
              <div class="value pull-right">
                <span class="value pull-right" ng-repeat="asoc in browser.project.value.associatedProjects">
                  {{asoc}}
                </span>
              </div>
            </div>
            <div class="meta-row">
              <div class="attr pull-left">
                <span>Keywords </span>
                <span class="text-danger">*</span>
                <a href="#" ng-click="publicationCtrl.openEditProject()">
                  <i class="fa fa-pencil-square-o"></i> Edit
                </a>
                <br/>
              </div>
              <div class="value pull-right">
                <span ng-repeat="keyword in browser.project.value.keywords.split(',')" style="display:block;">
                  <span class="text-danger" ng-if="publicationCtrl.isMissing(keyword)">
                    <i class="fa fa-exclamation-circle"></i>
                  </span>
                  {{keyword}}
                </span>
                <br/>
              </div>
            </div>
            <div class="meta-row">
              <span class="attr pull-left">Date of Publication
                <!-- <span style="font-style: italic; font-weight: normal"> Added by system</span> -->
              </span>
              <span class="value pull-right">{{browser.project.dateOfPublication()}}</span>
            </div>
            <div class="meta-row">
              <div class="attr pull-left">
                <span>Publisher
                  <!-- <span style="font-style: italic; font-weight: normal"> Added by system</span> -->
                </span>
              </div>
              <div class="value pull-right">
                <span>DesignSafe-CI</span>
              </div>
            </div>
            <div class="meta-row">
            </div>
          </div>
          <div class="content-wrapper" style="border-top: none">
            <h3 ng-if="publicationCtrl.isMissing(browser.publication.experimentsList)" class="text-danger" style="font-weight:500">Experiment Information
              <i class="fa fa-exclamation-circle"></i>
            </h3>
            <span ng-if="publicationCtrl.isMissing(browser.publication.experimentsList)" class="text-danger">You must include the details of your experiment</span>
          </div>
          <div class="content-wrapper" ng-repeat="exp in browser.publication.experimentsList | orderBy: ['_ui.order', 'value.title']">
            <h3 style="font-weight:500">Experiment Information</h3>
            <div class="meta-row">
              <div class="attr pull-left">
                <span>Experiment Title</span>
                <span class="text-danger">*</span>
                <a href="#" ng-click="publicationCtrl.openEditExperiments()">
                  <i class="fa fa-pencil-square-o"></i> Edit
                </a>
              </div>
              <div class="value pull-right">
                <span>{{exp.value.title}}</span>
              </div>
            </div>
            <div class="meta-row">
              <div class="attr pull-left">
                <span>Experiment Type</span>
                <span class="text-danger">*</span>
                <a href="#" ng-click="publicationCtrl.openEditExperiments()">
                  <i class="fa fa-pencil-square-o"></i> Edit
                </a>
              </div>
              <div class="value pull-right">
                <span style="text-transform:capitalize">{{exp.value.experimentType}}</span>
              </div>
            </div>
            <div class="meta-row">
              <div class="attr pull-left">
                <span>Experimental Facility</span>
                <span class="text-danger">*</span>
                <a href="#" ng-click="publicationCtrl.openEditExperiments()">
                  <i class="fa fa-pencil-square-o"></i> Edit
                </a>
              </div>
              <div class="value pull-right">
                <span>{{exp.getEF(browser.project.value.projectType, exp.value.experimentalFacility).label}}</span>
              </div>
            </div>
            <div class="meta-row">
              <div class="attr pull-left">
                <span>Authors</span>
                <span class="text-danger">*</span>
                <span ng-show="metaForm.$invalid">INVALID</span>
              </div>
              <div class="value pull-right">
                <div ng-repeat="user in publicationCtrl.filterUsers(exp.value.authors,
                              browser.publication.users) | orderBy: ['_ui.order', 'last_name']">
                  <span>
                    <span class="text-danger" ng-if="publicationCtrl.isMissing(user.first_name)">
                      <i class="fa fa-exclamation-circle"></i>
                    </span>
                    {{user.last_name}}, {{user.first_name}}
                  </span>
                </div>
              </div>
            </div>
            <div class="meta-row">
              <div class="attr pull-left">
                <span>Experiment Description</span>
                <span class="text-danger">*</span>
                <a href="#" ng-click="publicationCtrl.openEditExperiments()">
                  <i class="fa fa-pencil-square-o"></i> Edit
                </a>
              </div>
              <div class="value pull-right">
                <span>{{exp.value.description}}</span>
              </div>
            </div>
            <div class="meta-row">
              <div class="attr pull-left">
                <span>Model Configurations</span>
                <span class="text-danger">*</span>
                <a href="#" ng-click="publicationCtrl.openEditCategories([])">
                  <i class="fa fa-pencil-square-o"></i> Edit
                </a>
              </div>
              <div class="value pull-right">
                <span ng-repeat="model_config in browser.project.getRelated('modelconfig_set', exp.uuid)" style="display:block; color:#0567CC;">
                  <span class="text-danger" ng-if="publicationCtrl.isMissing(model_config.value.title)">
                    <i class="fa fa-exclamation-circle"></i>
                  </span>
                  {{model_config.value.title}}
                  <div style="color: black;">
                    <span class="text-danger" ng-if="publicationCtrl.isMissing(model_config.value.description)">
                      <i class="fa fa-exclamation-circle"></i>
                    </span>
                    {{model_config.value.description}}
                  </div>
                </span>
                <br/>
              </div>
            </div>
            <div class="meta-row">
              <div class="attr pull-left">
                <span>Sensor Information</span>
                <span class="text-danger">*</span>
                <a href="#" ng-click="publicationCtrl.openEditCategories([])">
                  <i class="fa fa-pencil-square-o"></i> Edit
                </a>
              </div>
              <div class="value pull-right">
                <span ng-repeat="sensor_list in browser.project.getRelated('sensorlist_set', exp.uuid)" style="display:block; color:#2EA89A;">
                  <span class="text-danger" ng-if="publicationCtrl.isMissing(sensor_list.value.title)">
                    <i class="fa fa-exclamation-circle"></i>
                  </span>
                  {{sensor_list.value.title}}
                  <div style="color: black;">
                    <span class="text-danger" ng-if="publicationCtrl.isMissing(sensor_list.value.description)">
                      <i class="fa fa-exclamation-circle"></i>
                    </span>
                    {{sensor_list.value.description}}
                  </div>
                </span>
                <br/>
              </div>
            </div>
            <div class="meta-row">
              <div class="attr pull-left">
                <span>Events</span>
                <span class="text-danger">*</span>
                <a href="#" ng-click="publicationCtrl.openEditCategories([])">
                  <i class="fa fa-pencil-square-o"></i> Edit
                </a>
              </div>
              <div class="value pull-right">
                <span ng-repeat="event in browser.project.getRelated('event_set', exp.uuid)" style="display:block; color:#D04348;">
                  <span class="text-danger" ng-if="publicationCtrl.isMissing(event.value.title)">
                    <i class="fa fa-exclamation-circle"></i>
                  </span>
                  {{event.value.title}}
                  <div style="color: black;">
                    <span class="text-danger" ng-if="publicationCtrl.isMissing(event.value.description)">
                      <i class="fa fa-exclamation-circle"></i>
                    </span>
                    {{event.value.description}}
                  </div>
                </span>
                <br/>
              </div>
            </div>
            <div class="meta-row">
              <div class="attr pull-left">
                <span>Date of Publication
                  <!-- <span style="font-style: italic; font-weight: normal"> Added by system</span> -->
                </span>
              </div>
              <div class="value pull-right">
                <span>{{browser.project.dateOfPublication()}}</span>
              </div>
            </div>
          </div>
          <div class="content-wrapper"  style="border-top: none">
            <h3 style="font-weight:500" ng-if="publicationCtrl.isMissing(browser.publication.analysisList)">Analysis Information</h3>
            <span ng-if="publicationCtrl.isMissing(browser.publication.analysisList)">It is recommended to include an analysis of your experiment.</span>
          </div>
          <div class="content-wrapper" ng-repeat="analysis in browser.publication.analysisList | orderBy: ['_ui.order', 'value.title']">
            <h3 style="font-weight:500">Analysis Information</h3>
            <div class="meta-row">
              <div class="attr pull-left">
                <span>Analysis Title</span>
                <span class="text-danger">*</span>
                <a href="#" ng-click="publicationCtrl.openEditCategories([])">
                  <i class="fa fa-pencil-square-o"></i> Edit
                </a>
              </div>
              <div class="value pull-right">
                <span class="text-danger" ng-if="publicationCtrl.isMissing(analysis.value.title)">
                  <i class="fa fa-exclamation-circle"></i>
                </span>
                <span>{{analysis.value.title}}</span>
              </div>
            </div>
            <div class="meta-row">
              <div class="attr pull-left">
                <span>Analysis Description</span>
                <span class="text-danger">*</span>
                <a href="#" ng-click="publicationCtrl.openEditCategories([])">
                  <i class="fa fa-pencil-square-o"></i> Edit
                </a>
              </div>
              <div class="value pull-right">
                <span class="text-danger" ng-if="publicationCtrl.isMissing(analysis.value.description)">
                  <i class="fa fa-exclamation-circle"></i>
                </span>
                <span>{{analysis.value.description}}</span>
              </div>
            </div>
            <div class="meta-row">
              <div class="attr pull-left">
                <span>Referenced Data</span>
                <a href="#" ng-click="publicationCtrl.openEditCategories([])">
                  <i class="fa fa-pencil-square-o"></i> Edit
                </a>
              </div>
              <div class="value pull-right">
                <span class="text-danger" ng-if="publicationCtrl.isMissing(analysis.value.referencedoi)">
                  <i class="fa fa-exclamation-circle"></i>
                </span>
                <span>{{analysis.value.reference}} {{analysis.value.referencedoi}}</span>
              </div>
            </div>
            <div class="meta-row">
              <div class="attr pull-left">
                <span>Date of Publication
                  <!-- <span style="font-style: italic; font-weight: normal"> Added by system</span> -->
                </span>
              </div>
              <div class="value pull-right">
                <span>{{browser.project.dateOfPublication()}}</span>
              </div>
            </div>
          </div>
          <div class="content-wrapper" style="border-top: none">
            <h3 style="font-weight:500" ng-if="publicationCtrl.isMissing(browser.publication.reportsList)">Report Information</h3>
            <span ng-if="publicationCtrl.isMissing(browser.publication.reportsList)">It is recommended to include a Report.</span>
          </div>
          <div class="content-wrapper" ng-repeat="report in browser.publication.reportsList | orderBy: ['_ui.order', 'value.title']">
            <h3 style="font-weight:500">Report Information</h3>
            <div class="meta-row">
              <div class="attr pull-left">
                <span>Report Title</span>
                <span class="text-danger">*</span>
                <a href="#" ng-click="publicationCtrl.openEditCategories([])">
                  <i class="fa fa-pencil-square-o"></i> Edit
                </a>
              </div>
              <div class="value pull-right">
                <span class="text-danger" ng-if="publicationCtrl.isMissing(report.value.title)">
                  <i class="fa fa-exclamation-circle"></i>
                </span>
                <span>{{report.value.title}}</span>
              </div>
            </div>
            <div class="meta-row">
              <div class="attr pull-left">
                <span>Report Description</span>
                <span class="text-danger">*</span>
                <a href="#" ng-click="publicationCtrl.openEditCategories([])">
                  <i class="fa fa-pencil-square-o"></i> Edit
                </a>
              </div>
              <div class="value pull-right">
                <span>{{report.value.description}}</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </form>
</div> <!-- END EXPERIMENTAL PUBLISHING STEPS -->


<div class="other-publishing-steps" ng-if="browser.showPreviewListing &&
        browser.project.value.projectType == 'other' ">
  <div class="meta-review" ng-if="browser.publishPipeline === 'meta'">
    <div class="meta-review header">
      <div class="col-sm-4"></div>
      <div class="col-sm-4" align="center">
        <p style="margin: 0px;">
          Proofread your metadata before publishing.
          <br>
          <span class="text-danger">* </span>
          <i>Indicates required metadata</i>
        </p>
      </div>
      <div class="col-sm-4" align="right">
        <a href="/help">Need Help?</a>
      </div>
    </div>
    <div class="content">
      <div class="content-wrapper" style="border-top: none">
        <h3 style="font-weight:500">Project Information</h3>
        <div class="meta-row">
          <div class="meta-row">
            <div class="attr pull-left">
              <span>Project Title </span>
              <span class="text-danger">*</span>
              <a href="#" ng-click="publicationCtrl.openEditProject()">
                <i class="fa fa-pencil-square-o"></i> Edit
              </a>
            </div>
            <div class="value pull-right">
              <span>{{browser.project.value.title}}</span>
            </div>
          </div>
          <div class="meta-row">
            <div class="attr pull-left">
              <span>Project Type </span>
              <span class="text-danger" style="text-transform:capitalize">*</span>
              <a href="#" ng-click="publicationCtrl.openEditProject()">
                <i class="fa fa-pencil-square-o"></i> Edit
              </a>
            </div>
            <div class="value pull-right">
              <span style="text-transform:capitalize">{{browser.project.value.projectType}}</span>
            </div>
          </div>
          <div class="meta-row">
            <div class="attr pull-left">
              <span>Participant Institutions </span>
              <span class="text-danger">*</span>
              <a href="#" ng-click="publicationCtrl.editInsts()">
                <i class="fa fa-pencil-square-o"></i> Edit
              </a>
            </div>
            <div class="value pull-right">
              <span ng-repeat="inst in browser.publication.institutions | filter: {_ui: {deleted: false }}" style="display:block;">
                {{inst.label}}
              </span>
            </div>
          </div>
          <div class="meta-row">
            <div class="attr pull-left">
              <span>Team Members </span>
              <span class="text-danger">*</span>
              <a href="#" ng-click="publicationCtrl.editUsers()">
                <i class="fa fa-pencil-square-o"></i> Edit
              </a>
            </div>
            <div class="value pull-right">
              <div ng-repeat="user in browser.publication.users | orderBy: ['_ui.order', 'last_name'] | filter: {_ui: {deleted: false }}">
                <button class="btn btn-sm btn-link pull-left" title="Move order Up" ng-click="publicationCtrl.moveOrderUp($index, user, browser.publication.users)"
                  style="padding:0;">
                  <i class="fa fa-arrow-up"></i>
                </button>
                <button class="btn btn-sm btn-link pull-left" title="Move order Down" ng-click="publicationCtrl.moveOrderDown($index, user, browser.publication.users)"
                  style="padding:0;">
                  <i class="fa fa-arrow-down"></i>
                </button>
                <span style="padding-left:1em"> {{user.last_name}}, {{user.first_name}}</span>
              </div>
            </div>
          </div>
          <div class="meta-row">
            <div class="attr pull-left">
              <span>Project Description </span>
              <span class="text-danger">*</span>
              <a href="#" ng-click="publicationCtrl.openEditProject()">
                <i class="fa fa-pencil-square-o"></i> Edit
              </a>
            </div>
            <div class="value pull-right">
              <span>{{browser.project.value.description}}</span>
            </div>
          </div>
          <div class="meta-row">
            <div class="attr pull-left">
              <span>Funding Agency & Awards </span>
              <span class="text-danger">*</span>
              <a href="#" ng-click="publicationCtrl.openEditProject()">
                <i class="fa fa-pencil-square-o"></i> Edit
              </a>
            </div>
            <div class="value pull-right">
              <span>{{browser.project.value.awardNumber}}</span>
            </div>
          </div>
          <div class="meta-row">
            <div class="attr pull-left">
              <span>Associated Projects</span>
              <a href="#" ng-click="publicationCtrl.openEditProject()">
                <i class="fa fa-pencil-square-o"></i> Edit
              </a>
            </div>
            <div class="value pull-right">
              <span class="value pull-right" ng-repeat="asoc in browser.project.value.associatedProjects">
                {{asoc}}
              </span>
            </div>
          </div>
          <div class="meta-row">
            <div class="attr pull-left">
              <span>Keywords </span>
              <span class="text-danger">*</span>
              <a href="#" ng-click="publicationCtrl.openEditProject()">
                <i class="fa fa-pencil-square-o"></i> Edit
              </a>
              <br/>
            </div>
            <div class="value pull-right">
              <span ng-repeat="keyword in browser.project.value.keywords.split(',')" style="display:block;">{{keyword}}</span>
              <br/>
            </div>
          </div>
          <div class="meta-row">
            <span class="attr pull-left">Date of Publication
              <!-- <span style="font-style: italic; font-weight: normal"> Added by system</span> -->
            </span>
            <span class="value pull-right">{{browser.project.dateOfPublication()}}</span>
          </div>
          <div class="meta-row">
            <div class="attr pull-left">
              <span>Publisher
                <!-- <span style="font-style: italic; font-weight: normal"> Added by system</span> -->
              </span>
            </div>
            <div class="value pull-right">
              <span>DesignSafe-CI</span>
            </div>
          </div>
          <div class="meta-row">
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

  <div class="agreement-div"
  ng-if="browser.showPreviewListing && browser.publishPipeline === 'agreement'"
  style="background:#fff; min-height:500px; padding:10px;">
    <h2>Choose licenses for your data</h2>
    <p>
      Read the <a href='/rw/support/data-publication/' target='_blank'>Curation Guidelines</a> page to determine the proper license for you data. <br />
      For your project type, we recommend:
    </p>
    <div>
      <input type="checkbox" name="odc_public" id="license-odc_public" />
      <label for="license-odc_public">
        <img src="/static/images/licenses/odc_public.png" width="64px" height="64px" style="margin-right:15px;">
        <span style="display:inline-block; width:400px;"> ODC Public Domain Dedication and License </span> <a href="https://opendatacommons.org/licenses/pddl/1-0/" target="_blank">License Website</a>
      </label>
    </div>
    <div>
      <input type="checkbox" name="odc_attrib" id="license-odc_attrib" />
      <label for="license-odc_attrib">
        <img src="/static/images/licenses/odc_attrib.png" width="64px" height="64px" style="margin-right:15px;">
        <span style="display:inline-block; width:400px;"> ODC Open Data Commons Attribution License </span> <a href="https://opendatacommons.org/licenses/by/" target="_blank">License Website</a>
      </label>
    </div>
    <div>
      <input type="checkbox" name="gnu" id="license-gnu" />
      <label for="license-gnu">
       <img src="/static/images/licenses/gnu.png" width="64px" height="64px" style="margin-right:15px;">
       <span style="display:inline-block; width:400px;"> GNU General Public License </span> <a href="https://www.gnu.org/licenses/gpl.html" target="_blank">License Website</a>
       </label>
     </div>
     <h5>Other Licenses: </h5>
     <div>
       <input type="checkbox" name="cc_attrib" id="license-cc_attrib" />
       <label for="license-cc_attrib">
         <img src="/static/images/licenses/cc_attrib.png" width="100px" style="margin-right:15px;">
         <span style="display:inline-block; width:400px;"> Creative Commons Attribution License </span> <a href="https://creativecommons.org/publicdomain/zero/1.0/" target="_blank">License Website</a>
       </label>
     </div>
     <div>
       <input type="checkbox" name="cc_public" id="license-cc_public" />
       <label for="license-cc_public">
         <img src="/static/images/licenses/cc_public.png" width="100px" style="margin-right:15px;">
         <span style="display:inline-block; width:400px;"> Creative Commons Public Domain Dedication License </span> <a href="https://creativecommons.org/licenses/by/4.0/" target="_blank">License Website</a>
       </label>
     </div>
     <h2>Agreement</h2>
     <p>
       I agree and understand that when I publish this data and receive a DOI that this will result in a locked, read-only publication that cannot be changed. If I have changes or revisions, this will result in a new DOI being created for the revised publication. I understand that my dataset meets the minimum metadata requirements per the <a href='/rw/support/data-publication/' target="_blank"> Data Curation and Publication Guidelines</a>.
      </p>
      <input type="checkbox" ng-click="publicationCtrl.togglePubAgreement()"> I agree
  </div> <!-- LICENSES END -->
